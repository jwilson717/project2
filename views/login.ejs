<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Create Account</title>
   <link rel="stylesheet" type='text/css' href="/css/bootstrap.css">
   <link rel="stylesheet" type='text/css' href="/css/styles.css">
   <link rel="stylesheet" type='text/css' href="/css/newaccountStyles.css">
</head>
<body>
   <main class='container'>
      <div class='row align-items-center justify-content-center'>
         <div class='col-lg-6 col-sm-12 col-md-12 my-auto border-dark rounded shadow-lg text-center p-3'>
            <h1>Login</h1>
            <hr>
            <div id='error'></div>
            <form id='loginform'>
               <div class='form-group input-group'>
                  <input type="text" name="username" id="username" class='form-control' placeholder="Username" required>
               </div>
               <div class='form-group input-group'>
                  <input type="password" name="password" id="password" class='form-control' placeholder="Password" required>
               </div>
               <button type='button' class='btn btn-primary' id='login'>Login</button>
            </form>
         </div>
      </div>      
   </main>
   <script src='jquery-3.5.1.min.js'></script>
   <script>
      $(document).ready(function () {
         $('#login').click(function () {
            $.post('/login', $('#loginform').serialize(), function (data) {
               let res = JSON.parse(data);
               if (res.status == 'Success') {
                  redirect($('#username').val())
               } else {
                  $('#error').html(res.msg);
               }
            });
         });
      });

      function redirect(name) {
         console.log(name);
         var f = document.createElement('form');
         f.action='/dashboard';
         f.method='POST';

         var i=document.createElement('input');
         i.type='text';
         i.name='username';
         i.value= name;
         f.appendChild(i);

         document.body.appendChild(f);
         f.submit();
      }
   </script>
</body>
</html>